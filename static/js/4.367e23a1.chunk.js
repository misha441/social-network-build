(this["webpackJsonpfirst-app"]=this["webpackJsonpfirst-app"]||[]).push([[4],{299:function(e,s,a){e.exports={dialogs:"Dialogs_dialogs__z01l7",dialogUser:"Dialogs_dialogUser__floW5",active:"Dialogs_active__3HGsy",dialogsUserPhoto:"Dialogs_dialogsUserPhoto__2ibkk",dialogsItem:"Dialogs_dialogsItem__3MUqk",dialog:"Dialogs_dialog__2EPxW",messagesBlockWrapper:"Dialogs_messagesBlockWrapper__3LX8X",selectedUserInfo:"Dialogs_selectedUserInfo__spwZP",messagesWrapper:"Dialogs_messagesWrapper__3_1zv",dialogDateStyle:"Dialogs_dialogDateStyle__1F5ZY",massagesBlock:"Dialogs_massagesBlock__3W46A",messageWrapper:"Dialogs_messageWrapper__2r02C",message:"Dialogs_message__3y9CQ",yourMessage:"Dialogs_yourMessage__1DN-z",messageText:"Dialogs_messageText__EUK7N",messageUserPhoto:"Dialogs_messageUserPhoto__1Wqn4",sendingField:"Dialogs_sendingField__2YyZC",dialogs__sendMessageForm:"Dialogs_dialogs__sendMessageForm__1i4Hw",dialogs__sendMessageFormButton:"Dialogs_dialogs__sendMessageFormButton__8nsb5",dialogs__textArea:"Dialogs_dialogs__textArea__1orQJ",dialogs__tsendButton:"Dialogs_dialogs__tsendButton__3J2dG",followBtn:"Dialogs_followBtn__2ohbZ"}},305:function(e,s,a){"use strict";a.r(s);var t=a(4),o=a(0),r=a(60),i=a(61),l=a(63),d=a(62),n=a(1),c=a.n(n),g=a(135),m=a(299),u=a.n(m),h=a(19),j=a(103),_=function(e){return Object(o.jsx)("div",{className:u.a.dialog,children:Object(o.jsxs)(h.b,{to:"/dialogs/"+e.id,className:u.a.dialogUser,activeClassName:u.a.active,children:[Object(o.jsx)("div",{children:Object(o.jsx)("img",{className:u.a.dialogsUserPhoto,src:null!=e.photo?e.photo:j.a,alt:""})}),e.name]})})},p=a(79),b=a.n(p),O=function(e){return Object(o.jsx)("div",{children:e.sender===e.authUserId?Object(o.jsxs)("div",{className:b()(u.a.messageWrapper,u.a.yourMessage),children:[Object(o.jsxs)("div",{className:u.a.message,children:[Object(o.jsx)("div",{className:u.a.messageText,dangerouslySetInnerHTML:{__html:e.message}}),Object(o.jsx)("span",{children:e.dateFormattingToHours(e.addedAt)})]}),Object(o.jsx)("div",{className:u.a.messageUserPhoto,children:Object(o.jsx)("img",{src:e.authUserPhotos.small?e.authUserPhotos.small:j.a,alt:""})})]}):Object(o.jsxs)("div",{className:u.a.messageWrapper,children:[Object(o.jsx)("div",{className:u.a.messageUserPhoto,children:Object(o.jsx)("img",{src:e.selectedUserPhoto.small?e.selectedUserPhoto.small:j.a,alt:""})}),Object(o.jsxs)("div",{className:u.a.message,children:[e.message,Object(o.jsx)("span",{children:e.dateFormattingToHours(e.addedAt)})]})]})})},f=a(136),x=a(137),v=a(39),U=a(54),D=a(50),P=Object(U.a)(100),F=Object(x.a)({form:"dialogAddMessageForm"})((function(e){return Object(o.jsxs)("form",{onSubmit:e.handleSubmit,className:u.a.dialogs__sendMessageForm,children:[Object(o.jsx)("div",{children:Object(o.jsx)(f.a,{component:v.b,name:"newMessageBody",className:u.a.dialogs__textArea,validate:[U.b,P],placeholder:"Enter new message"})}),Object(o.jsx)("div",{className:u.a.dialogs__sendMessageFormButton,children:Object(o.jsx)("button",{className:u.a.dialogs__tsendButton,children:"SEND"})})]})})),N=function(e){var s=c.a.createRef(),a=e.dialogsPage,t="";Object(n.useEffect)((function(){s.current.scrollTop=s.current.scrollHeight-s.current.clientHeight}),[e.dialogsPage.messages]);var r=function(s){if(e.dateFormattingToDate(s.addedAt)!==t)return t=e.dateFormattingToDate(s.addedAt),Object(o.jsx)("div",{className:u.a.dialogDateStyle,children:Object(o.jsx)("span",{children:e.dateFormattingToDate(s.addedAt)})})},i=a.dialogs.map((function(e){return Object(o.jsx)(_,{name:e.userName,id:e.id,photo:e.photos.large},e.id)})),l=a.messages.map((function(s){return Object(o.jsxs)(o.Fragment,{children:[r(s),Object(o.jsx)(O,{message:s.body,sender:s.senderId,selectedUserPhoto:e.selectedUserPhoto,authUserId:e.authUserId,authUserPhotos:e.authUserPhotos,dateFormattingToHours:e.dateFormattingToHours,addedAt:s.addedAt},s.id)]})}));return Object(o.jsxs)("div",{className:u.a.dialogs,children:[Object(o.jsx)("div",{className:b()(u.a.dialogsItem,"scrollbarStyle"),children:i}),Object(o.jsxs)("div",{className:u.a.messagesBlockWrapper,children:[e.isFetching?Object(o.jsx)(D.a,{}):null,e.selectedUserId?Object(o.jsxs)("div",{className:b()(u.a.selectedUserInfo),children:[Object(o.jsx)("img",{src:e.selectedUserPhoto.small?e.selectedUserPhoto.small:j.a,alt:""}),Object(o.jsx)("div",{children:e.selectedUserFullName})]}):Object(o.jsx)("div",{className:b()(u.a.selectedUserInfo),children:Object(o.jsx)("img",{src:j.a,alt:""})}),Object(o.jsx)("div",{ref:s,className:b()(u.a.messagesWrapper,"scrollbarStyle"),children:l}),Object(o.jsx)("div",{className:u.a.sendingField,children:Object(o.jsx)(F,{onSubmit:function(s){e.sendMessage(e.selectedUserId,s.newMessageBody)}})})]})]})},y=a(23),I=a(13),M=function(e){return{isAuth:e.auth.isAuth}},T=a(10),k=function(e){Object(l.a)(a,e);var s=Object(d.a)(a);function a(){var e;Object(r.a)(this,a);for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return(e=s.call.apply(s,[this].concat(o))).dateFormattingToHours=function(e){var s=e.split("T")[1].split(":");return s[0]+":"+s[1]},e.dateFormattingToDate=function(e){return e.split("T")[0].split("-").reverse().join(".")},e}return Object(i.a)(a,[{key:"refreshProfile",value:function(){var e=this.props.match.params.userId;e&&this.props.getMessages(e)}},{key:"componentDidMount",value:function(){this.props.getFriends(),this.refreshProfile()}},{key:"componentWillUnmount",value:function(){this.props.setSelectedUserId(null),this.props.setMessages([])}},{key:"componentDidUpdate",value:function(e,s,a){this.props.match.params.userId!==e.match.params.userId&&this.refreshProfile()}},{key:"render",value:function(){return Object(o.jsx)(N,Object(t.a)(Object(t.a)({},this.props),{},{dateFormattingToHours:this.dateFormattingToHours,dateFormattingToDate:this.dateFormattingToDate}))}}]),a}(c.a.Component);s.default=Object(T.d)(Object(y.b)((function(e){return{dialogsPage:e.dialogsPage,pageSize:e.dialogsPage.pageSize,selectedUserId:e.dialogsPage.selectedUserId,selectedUserPhoto:e.dialogsPage.selectedUserPhoto,selectedUserFullName:e.dialogsPage.selectedUserFullName,authUserId:e.auth.id,authUserPhotos:e.auth.photos,isFetching:e.dialogsPage.isFetching}}),{sendMessageCreator:g.e,getFriends:g.b,getMessages:g.c,sendMessage:g.d,setSelectedUserId:g.g,setMessages:g.f}),(function(e){var s=function(s){Object(l.a)(n,s);var a=Object(d.a)(n);function n(){return Object(r.a)(this,n),a.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return this.props.isAuth?Object(o.jsx)(e,Object(t.a)({},this.props)):Object(o.jsx)(I.a,{to:"/login"})}}]),n}(c.a.Component);return Object(y.b)(M)(s)}))(k)}}]);
//# sourceMappingURL=4.367e23a1.chunk.js.map